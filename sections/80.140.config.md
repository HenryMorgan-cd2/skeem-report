## Configuration {#sec_config}

Many aspects of skeem work off of application wide configuration, items such as the database connection information, the preferred file provider, or the session secret key. This information does not make sense to exist (and some parts can't be) in the schema as they configure skeem as a whole and are not application specific. Many of these configuration options also change depending on the current environment. This configuration is stored in a JSON file named `skeem.json`

When running a command in the CLI, the system searches recursively upwards from the current working directory looking for this `skeem.json` file. If this file is not found before the root directory is hit, then an error is thrown stating that you are attempting to run a command when not inside a skeem application. When the file is found, its location is marked as the root directory for all relative paths.

### Different Environments

Throughout a projects life time it will be run in multiple environments such as development or production. Each environment will likely want its own configuration. For instance when developing an application you would want to store files locally for speed and cost, whereas, in production you probable want to use a cloud storage solution such as AWS.

The configuration for different environments can be declared within the configuration file by nesting all the options within an object and making the key equal to the name of the environment. Skeem looks at the `NODE_ENV` environment variable in order to determine which configuration block should be loaded. `NODE_ENV` is a standard variable throughout the node ecosystem used to determine the current environment.

```{.javascript caption="An example of a config with multiple environments."}
{
  developments: {
    /* development config */
  },
  production: {
    /* production config */
  }
}
```

### Environment Variables

There are many settings in skeem for which the value may not want to be hardcoded. This may be because the value is likely to change often, may be different for each developer, or because the value should be kept secret and so would want to avoid be committed into the applications repository. The solution to that is the use of environment variables. Environment variables provide run time configuration options to many programs and are used to solve this issue within skeem.

To use an environment variable you must set the value of the configuration item to be `{ $env: 'name of env variable' }`. Skeem searches all values of the configuration for objects in this form and substitutes them for the specified variable. If this variable does not exist an error is thrown.

To further facilitate the use of these variables skeem will automatically search for a file in the application root named ".env". This file should contain key value pairs. Upon starting, skeem will automatically load this file and merge the contained variables into the environment prior to passing the configuration.

```{.javascript caption="Configuration which uses enviroment variables to avoid exposing critical infomation"}
{
  database: {
    host: { $env: "DATABASE_HOST" },
    username: { $env: "DATABASE_USERNAME" },
    password: { $env: "DATABASE_PASSWORD" },
  },
}
```

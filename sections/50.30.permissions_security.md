## Permissions and Authentication

The client should always be assumed to be dangerous and because queries can be sent directly from them it is imperative to be able to ensure their identity and limit their access accordingly.

### Authentication

Before we can control a users access we must first be able to determine who they are. Skeem provides a couple of ways in which to authenticate someone: stored identifier (email, username, etc) with a password or through an oauth2.0 provider such as Facebook or Google.

Skeem allows for multiple session providers to be created, this allows sites to present users with multiple options to log in.

![The log in screen for Resooma.com showing options to authenticate with email and password or by google or facebook](images/login_screen_for_resooma.png){width=8cm}

### Permissions

With authentication we now have two distinct user states: authenticated and anonymous. Each model allows for a default scope to be applied for each of these roles, meaning that you can declare that only authenticated people are able to view all articles whereas anonymous people may only view public ones.

By using the `session` operator it is possible to define permissions relating to the current user, for instance users may only access their own addresses.

```{caption="A scope that only passes when the user record is equal to the current session."}
{ eq: [ { session: true }, { attr: 'user' } ] }
```

### Roles

Often sites have a clear set of user groups such as admins, authors, sellers, or guests. Skeem allows for the declaration of additional roles. These roles have a name and a scope used to determine if a particular user has the role. Users can have multiple roles simultaneously.

Permissions can be defined on each model for each of the custom defined role. When resolving if a user can access a given record Skeem opts for the most lenient restriction. For instance if authenticated users cannot access the addresses model but admins can, then skeem would allow anyone who is both authenticated and an admin to access the records.
